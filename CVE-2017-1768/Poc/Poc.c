#include <stdio.h>
#include <windows.h>

int main()
{
	HANDLE hDevice;
	DWORD lpbReturn = 0;
	hDevice = CreateFileA("\\\\.\\USBPcap1",
		GENERIC_READ | GENERIC_WRITE,
		NULL,
		NULL,
		OPEN_EXISTING,
		NULL,
		NULL);


	if (hDevice == INVALID_HANDLE_VALUE)
	{
		printf("[-] CreateFile failed (%.08x)\n", GetLastError());
		return -1;
	}
	BOOL bResult = DeviceIoControl(hDevice, 
		0x00090000, 
		(LPVOID)0x1, 
		(DWORD)0, 
		NULL, 
		0, 
		&lpbReturn,
		NULL);

	if (!bResult)
	{
		printf("[-] DeviceIOControl failed (%.08x)\n", GetLastError());
		return 0;
	}

	return 0;
}